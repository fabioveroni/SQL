-- Code developed by Fábio Veroni
-- FILES OF TAX INVOICES INVOICED IN THE MONTH


--------------------******************** TAX INVOICES PAID OUT IN THE MONTH ********************--------------------


Select DISTINCT
-- RE.ESTNCODIGO,
    (0) AS ORIGEM_P1,
    (3) AS TIPO_P2,
    CASE WHEN 
        RF.CGC_CPF IS NULL THEN TO_CHAR ('00000000000000')
    ELSE 
        LPAD(translate(RF.CGC_CPF,' .-/', ' '),14,'0')
    END AS CGC_CPF_P3,
    CASE WHEN
        RF.MOEDA='R' THEN RE.ESTCSIGLA  -- Ajustar Para ter 2 digitos. Aguardar resposta Rosângela.
    ELSE
        'EX'
    END AS UF_P17,
    CASE WHEN
        RF.INSC_ESTADUAL='Isenta' or RF.INSC_ESTADUAL IS NULL THEN ('00000000000000000000')
    ELSE
        LPAD(translate(RF.INSC_ESTADUAL,' .-/', ' '),20,'0') 
    END AS IE_P19,
    -- LPAD(NF.SERIE,6,'0') AS SERIE,
    ('%%%%%%') AS SERIE_P39,
    ('%%%%%%') AS SUBSERIE_P45,    
    LPAD(NF.NUMERO_NFE,10,'0') AS NUMERONF_P51,
    ('000') AS DESD_P61,
    translate(TO_CHAR(NF.DATAEMISSAO_NFE,'DD/MM/YYYY'),' .-/', ' ') AS DATA_EMISSAO_P64,
    
       -- EDIÇÃO AJUSTE SOLICITACAO CONTABILIDADE - 23/02/2022
    CASE WHEN 
        FCAR.CRCCPARCELA IS NULL  THEN LPAD((RF.NUMERO || '-' || 1) ,20,'0')
    ELSE
        LPAD((RF.NUMERO || '-' || FCAR.CRCCPARCELA) ,20,'0')
    END AS NUFATURA_P72,
    /*
    TO_CHAR('-') AS LIGACAO,
    CASE WHEN 
        FCAR.CRCCPARCELA = '1' THEN ('1.1')
        ELSE FCAR.CRCCPARCELA
    END AS PARCELA,
  */   
    translate(TO_CHAR(RF.DATA_VENC,'DD/MM/YYYY'),' .-/', ' ') AS DATA_VENC_P92, 
    -- LPAD(TO_NUMBER(REPLACE(TO_CHAR(NF.HONOR,'99999999999999D99'),',',''),'99999999999999'),14,'0') AS VAL_BRUTO, -- Colocar Mascara 
   
   CASE WHEN
         RF.MOEDA='R' THEN LPAD(REPLACE(TO_CHAR(FCAR.CRCNVALORHONORARIO,'FM999999999D90'),',','.') ,14,'0')
   ELSE     
        LPAD(REPLACE(TO_CHAR(NF.HONOR,'FM999999999D90'),',','.') ,14,'0')      
   END AS VAL_BRUTO_P100, 
    -- LPAD(TO_NUMBER(REPLACE(TO_CHAR(NF.IRRF,'99999999999999D99'),',',''),'99999999999999'),14,'0') AS IRRF,
    LPAD(REPLACE(TO_CHAR(NF.IRRF,'FM999999999D90'),',','.') ,14,'0')   AS IRRF_P114, 
    
   -- regexp_replace(replace(LPAD(NF.IRRF, 11,'0'),',',''),'([0-9]{2})([0-9]{3})([0-9]{3})','\1.\2.\3.') as teste, -- 99.999.999.999
    
    -- regexp_replace(LPAD('00000000191', 11),'([0-9]{3})([0-9]{3})([0-9]{3})','\1.\2.\3-') as CPF from dual;
    
   --  LPAD(TO_NUMBER(REPLACE(TO_CHAR(NF.PIS,'99999999999999D99'),',',''),'99999999999999'),14,'0') AS PIS,
      
   -- COMENTADO EM 07/12/2022 - ALTERAÇÃO DO ARQUIVO TXT PARA CONTABILIDADE - SAI VALOR NF.PIS E ENTRA FCAR.CRCNVALORPIS    
   --  LPAD(REPLACE(TO_CHAR(NF.PIS,'FM999999999D90'),',','.') ,14,'0')   AS PIS_P128,
    LPAD(REPLACE(TO_CHAR(FCAR.CRCNVALORPIS,'FM999999999D90'),',','.') ,14,'0')   AS PIS_P128,
   
   -- COMENTADO EM 07/12/2022 - ALTERAÇÃO DO ARQUIVO TXT PARA CONTABILIDADE - SAI VALOR NF.COFINS E ENTRA FCAR.CRCNVALORCOFINS
   -- LPAD(TO_NUMBER(REPLACE(TO_CHAR(NF.COFINS,'99999999999999D99'),',',''),'99999999999999'),14,'0') AS COFINS,
   -- LPAD(REPLACE(TO_CHAR(NF.COFINS,'FM999999999D90'),',','.') ,14,'0')   AS COFINS_P142,
    LPAD(REPLACE(TO_CHAR(FCAR.CRCNVALORCOFINS,'FM999999999D90'),',','.') ,14,'0')   AS COFINS_P142,
     
    -- COMENTADO EM 07/12/2022 - ALTERAÇÃO DO ARQUIVO TXT PARA CONTABILIDADE - SAI VALOR NF.CSLL E ENTRA FCAR.CRCNVALORCSLL
    -- LPAD(TO_NUMBER(REPLACE(TO_CHAR(NF.CSLL,'99999999999999D99'),',',''),'99999999999999'),14,'0') AS CSLL,
    -- LPAD(REPLACE(TO_CHAR(NF.CSLL,'FM999999999D90'),',','.') ,14,'0')   AS CSLL_P156,
    LPAD(REPLACE(TO_CHAR(FCAR.CRCNVALORCSLL,'FM999999999D90'),',','.') ,14,'0')   AS CSLL_P156,
    
    -- COMENTADO EM 07/12/2022 - ALTERAÇÃO DO ARQUIVO TXT PARA CONTABILIDADE - TRATAMENTO DE MOEDA NACIONAL E INTERNACIONAL
    -- LPAD(TO_NUMBER(REPLACE(TO_CHAR(((((NF.HONOR-NF.IRRF)-NF.PIS)-NF.COFINS)-NF.CSLL),'99999999999999D99'),',',''),'99999999999999'),14,'0') AS VAL_LIQ,
    -- LPAD(REPLACE(TO_CHAR(((((NF.HONOR-NF.IRRF)-NF.PIS)-NF.COFINS)-NF.CSLL),'FM999999999D90'),',','.') ,14,'0') AS VAL_LIQ_P170,
    CASE WHEN
        RF.MOEDA='R' THEN LPAD(REPLACE(TO_CHAR(((((FCAR.CRCNVALORHONORARIO-NF.IRRF)-FCAR.CRCNVALORPIS)-FCAR.CRCNVALORCOFINS)-FCAR.CRCNVALORCSLL),'FM999999999D90'),',','.') ,14,'0') 
    ELSE    
        LPAD(REPLACE(TO_CHAR(NF.HONOR,'FM999999999D90'),',','.') ,14,'0')
    END AS VAL_LIQ_P170,   
    
   -- FCAR.CRCDRECEBIMENTO,
  -- SYSDATE,
   
    -- CASE WHEN FCAR.CRCDRECEBIMENTO<=SYSDATE THEN ('2')    ELSE ('1')     AS COMPESACAO,
      
    translate(TO_CHAR(FCAR.CRCDRECEBIMENTO,'DD/MM/YYYY'),' .-/', ' ') AS COMPESACAO_P184,
      
   -- ('00000000000') AS COD_CONTABIL,  --- Pos 192
    CASE WHEN    
        FCAR.PCTCNUMEROCONTAREC='400.010.0010' THEN ('000001.0005')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0001')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0003')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0002')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0004')
      WHEN
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0001')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0003')
      WHEN 
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0002')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0004')
    ELSE FCAR.PCTCNUMEROCONTAREC       
       END AS COD_CONTABIL_P192,    
    /*
    CASE WHEN 
        RF.MOEDA='R' THEN TO_CHAR('00000000201')
    ELSE 
        TO_CHAR('00000000202')
    END AS COD_CONTABIL,
    */
    translate(TO_CHAR(RF.DATA_PAGTO,'DD/MM/YYYY'),' .-/', ' ') AS DATA_PAG_P203,
    translate(TO_CHAR(RF.DATA_PAGTO,'DD/MM/YYYY'),' .-/', ' ') AS DATA_RAZAO_P211,
     /*
   CASE WHEN    
        RF.MOEDA='R' THEN  LPAD(TO_NUMBER(REPLACE(TO_CHAR(FCAR.CRCNVALORRECEBIDO,'99999999999999D99'),',',''),'99999999999999'),14,'0')
    ELSE 
        LPAD(TO_NUMBER(REPLACE(TO_CHAR((FCAR.CRCNVALORRECEBIDO * FCAR.CRCNCOTACAO),'99999999999999D99'),',',''),'99999999999999'),14,'0')
    END AS VAL_PAGO,
    ('00000000000') AS COD_CONTAB_PAG,
     */ 
    CASE WHEN    
        RF.MOEDA='R' THEN  LPAD(REPLACE(TO_CHAR(FCAR.CRCNVALORRECEBIDO,'FM999999999D90'),',','.'),14,'0')
    ELSE 
       LPAD(REPLACE(TO_CHAR((FCAR.CRCNVALORRECEBIDO * FCAR.CRCNCOTACAO),'FM999999999D90'),',','.'),14,'0')
    END AS VAL_PAGO_P219,
    
    -- ('00000000000') AS COD_CONTAB_PAG,  -- POS 233
     CASE WHEN    
        FCAR.PCTCNUMEROCONTAREC='400.010.0010' THEN ('000001.0005')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0001')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0003')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0002')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0004')
      WHEN
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0001')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0003')
      WHEN 
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0002')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0004')
    ELSE FCAR.PCTCNUMEROCONTAREC       
       END AS COD_CONTABIL_PAG_P233,    
    /*
    CASE WHEN
        FCAR.CRCNDESCRECHON=0 OR FCAR.CRCNDESCRECHON<0 OR FCAR.CRCNDESCRECHON IS NULL THEN TO_CHAR('00000000000000') 
    WHEN               
        RF.MOEDA<>'R' THEN  LPAD(TO_NUMBER(REPLACE(TO_CHAR((FCAR.CRCNDESCRECHON*FCAR.CRCNCOTACAO),'99999999999999D99'),',',''),'99999999999999'),14,'0')
    ELSE 
        LPAD(TO_NUMBER(REPLACE(TO_CHAR(FCAR.CRCNDESCRECHON,'99999999999999D99'),',',''),'99999999999999'),14,'0')
    END AS JUR_MUL, 
    */
    CASE WHEN
        FCAR.CRCNDESCRECHON=0 OR FCAR.CRCNDESCRECHON<0 OR FCAR.CRCNDESCRECHON IS NULL THEN TO_CHAR('00000000000.00') 
    WHEN               
        RF.MOEDA<>'R' THEN  LPAD(REPLACE(TO_CHAR((FCAR.CRCNDESCRECHON*FCAR.CRCNCOTACAO),'FM999999999D90'),',','.'),14,'0')
    ELSE 
        LPAD(REPLACE(TO_CHAR(FCAR.CRCNDESCRECHON,'FM999999999D90'),',','.'),14,'0')
    END AS JUR_MUL_P244,
     -- ('00000000000') AS COD_CONT_JUR_MUL,
        
    CASE WHEN    
        FCAR.PCTCNUMEROCONTAREC='400.010.0010' THEN ('000000.0000')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0001')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0003')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0002')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0004')
      WHEN
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0001')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0003')
      WHEN 
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0002')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0004')
    ELSE FCAR.PCTCNUMEROCONTAREC       
       END AS COD_CONT_JUR_MUL_P258,
          /*
    CASE WHEN
        FCAR.CRCNDESCRECHON>0 OR FCAR.CRCNDESCRECHON IS NULL THEN TO_CHAR('00000000000000')
    WHEN 
        RF.MOEDA<>'R' THEN  LPAD(TO_NUMBER(REPLACE(TO_CHAR((FCAR.CRCNDESCRECHON*FCAR.CRCNCOTACAO)*(-1),'99999999999999D99'),',',''),'99999999999999'),14,'0')
    ELSE   
        LPAD(TO_NUMBER(REPLACE(TO_CHAR(FCAR.CRCNDESCRECHON*(-1),'99999999999999D99'),',',''),'99999999999999'),14,'0')
    END AS DESCONTO,
    */
     CASE WHEN
        FCAR.CRCNDESCRECHON>0 OR FCAR.CRCNDESCRECHON IS NULL THEN TO_CHAR('00000000000.00')
    WHEN 
        RF.MOEDA<>'R' THEN  LPAD(REPLACE(TO_CHAR((FCAR.CRCNDESCRECHON*FCAR.CRCNCOTACAO)*(-1),'FM999999999D90'),',','.'),14,'0')
    ELSE   
        LPAD(REPLACE(TO_CHAR(FCAR.CRCNDESCRECHON*(-1),'FM999999999D90'),',','.'),14,'0')
    END AS DESCONTO_P269,
    -- ('00000000000') AS COD_CONT_DESC,
    CASE WHEN    
        FCAR.PCTCNUMEROCONTAREC='400.010.0010' THEN ('000000.0000')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0001')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0020' THEN ('000001.0003')
      WHEN
        RF.MOEDA='R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0002')
      WHEN
        RF.MOEDA<>'R' AND FCAR.PCTCNUMEROCONTAREC='100.010.0010' THEN ('000001.0004')
      WHEN
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0001')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0020' THEN ('000001.0003')
      WHEN 
        FL.CODIGO='R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0002')
      WHEN
        FL.CODIGO<>'R' AND FL.PCTCNUMEROCONTADEST='100.010.0010' THEN ('000001.0004')
    ELSE FCAR.PCTCNUMEROCONTAREC       
       END AS COD_CONT_DESC_P283,    
    ('000000') AS JUROSAOMES_P294,
    ('S') AS INTEGRA_P300,
    /*
    CASE WHEN
        RF.MOEDA<>'R' THEN LPAD(TO_NUMBER(REPLACE(TO_CHAR((FCAR.CRCNVALORRECEBIDO * FCAR.CRCNCOTACAO),'99999999999999D99'),',',''),'99999999999999'),14,'0')
    ELSE
        LPAD(TO_NUMBER(REPLACE(TO_CHAR(FCAR.CRCNVALORRECEBIDO,'99999999999999D99'),',',''),'99999999999999'),14,'0')
    END AS BASE_CALCULO,
    */
    /*
    CASE WHEN
        RF.MOEDA<>'R' THEN LPAD(REPLACE(TO_CHAR((FCAR.CRCNVALORRECEBIDO * FCAR.CRCNCOTACAO),'FM999999999D90'),',','.'),14,'0')
    ELSE
        LPAD(REPLACE(TO_CHAR(FCAR.CRCNVALORRECEBIDO,'FM999999999D90'),',','.'),14,'0')  ----- VERIFICAR COM A ROSANGELA (NF.HONOR)
    END AS BASE_CALCULO,
        */
    
                         -- select CRCNVALORHONORARIO from FINANCE.CONTASRECEBER
    
    -- EDIÇÃO AJUSTE SOLICITACAO CONTABILIDADE - 23/02/2022
    CASE WHEN
            RF.MOEDA='R' AND FCAR.CRCNDESCRECHON<0
         THEN 
            LPAD(REPLACE(TO_CHAR((FCAR.CRCNVALORHONORARIO + FCAR.CRCNDESCRECHON),'FM999999999D90'),',','.'),14,'0')
         WHEN
            RF.MOEDA='R' AND FCAR.CRCNDESCRECHON>=0
         THEN
             LPAD(REPLACE(TO_CHAR((FCAR.CRCNVALORHONORARIO),'FM999999999D90'),',','.'),14,'0')         
         ELSE 
            LPAD(REPLACE(TO_CHAR((NF.HONOR),'FM999999999D90'),',','.'),14,'0') 
           -- LPAD(REPLACE(TO_CHAR(((FCAR.CRCNVALORHONORARIO - FCAR.CRCNDESCRECHON)* FCAR.CRCNCOTACAO),'FM999999999D90'),',','.'),14,'0')       
    END AS BASE_CALC_P301,  
    --LPAD(REPLACE(TO_CHAR((NF.HONOR),'FM999999999D90'),',','.'),14,'0') AS BASE_CALCULO,
        
    ('1') AS NATUREZA_P315,
    ('%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%') AS PROC_PIS_COFINS_P316,
    CASE WHEN    
        RF.MOEDA='R' THEN  ('01')
    ELSE 
       ('99')
    END AS TIP_PAG_P348,
    CASE WHEN    
        RF.MOEDA='R' THEN  ('%%%%%%%%%%%%%%%%%%%%%%%%%')
    ELSE 
       ('HONORARIOS INTERNACIONAIS') 
    END AS IDIC_PAG_P350    
    
    FROM  RCR.FATURA RF 
    
    -- SELECT * FROM RCR.FATURA WHERE NUMERO =44849
    -- SELECT * FROM  RCR.NOTAFISCAL
    
    FULL  JOIN RCR.ESTADO RE ON (RF.ESTNCODIGO=RE.ESTNCODIGO)
          INNER JOIN RCR.NOTAFISCAL NF  ON (RF.NUMERO=NF.NUMERO)           
          INNER JOIN FINANCE.CONTASRECEBER FCAR ON (RF.NUMERO=FCAR.CRCNFATURA)
          FULL JOIN TEMP_ADI T ON (RF.NUMERO=T.ADINFATURA)
          FULL JOIN FINANCE.LANCAMENTO FL ON (T.ADINLANCAMENTO=FL.LANNCODIG)
  
    WHERE  NF.ORGNCODIG=1
    -- and fcar.crcnfatura=114380 -- CHECKING - VALIDATION
    
    AND FCAR.CRCDRECEBIMENTO>='01-07-2024' AND FCAR.CRCDRECEBIMENTO<'01-08-2024' -- ADJUST DATE TO THE FIRST DAY OF THE PREVIOUS MONTH AND LESS THAN THE FIRST DAY OF THE CURRENT MONTH
    AND NF.DATA_CANC IS NULL
    -- AND NF.DATA_EMISSAO>='01-01-2022'  AND NF.DATA_EMISSAO<'01-01-2023' -- 2022 -- CAMPO DE FILTRO DO ANO DE EMISSÃO  -- YEAR OF ISSUANCE FILTER FIELD (2022)
    -- AND NF.DATA_EMISSAO>='01-01-2023'  AND NF.DATA_EMISSAO<'01-01-2024' -- 2023 -- CAMPO DE FILTRO DO ANO DE EMISSÃO  -- YEAR OF ISSUANCE FILTER FIELD (2023)
    -- AND NF.DATA_EMISSAO>='01-01-2024'  AND NF.DATA_EMISSAO<'01-01-2025' -- 2024 -- CAMPO DE FILTRO DO ANO DE EMISSÃO  -- YEAR OF ISSUANCE FILTER FIELD (2025)
    -- AND NF.DATA_EMISSAO>='01-01-2021'  
    ORDER BY  8,13
    
    
        ------------------------------------------TESTING AND CONSULTATION FIELD------------------------------------------
    
  -- SELECT * FROM FINANCE.CONTASRECEBER WHERE CRCNFATURA='44630'  
  
  -- SELECT NUMERONF, NUMERO_NFE FROM RCR.NOTAFISCAL ORDER BY 1 
  -- WHERE NUMERONF=3701 
  -- NUMERONF, NUMERO_NFE,
  -- where FCAR.CRCNVALORRECEBIDO<0
 --  and nf.orgncodig=2 

    --WHERE NF.DATA_EMISSAO>='01-05-2021' AND NF.DATA_EMISSAO<'01-06-2021' -- Inserir aqui o Intervalo de Datas
    -- and FCAR.CRCNVALORRECEBIDO<0
      
 -- WHERE RF.MOEDA<>'R'
      --  select * from RCR.NOTAFISCAL  where numeronf=3570
        -- select  * from FINANCE.CONTASRECEBER WHERE  crcnnotafiscal= 3570
     /*-- SELECT * FROM RCR.FATURA
      select to_char(12131.1, 'FM999G999G999D90', 'nls_numeric_characters='',.''')
from   dual
       SELECT regexp_replace(LPAD('00000000191', 11),'([0-9]{3})([0-9]{3})([0-9]{3})','\1.\2.\3.') as CPF from dual;
        select to_char(19,'99999999999999D99') from dual;
       --  where nf.serie<>'A' and nf.serie<>'1'
    */
 --   SELECT TO_DATE(TO_CHAR(sysdate, 'DD/MM/YYYY'), 'DD/MM/YYYY') AS data_formatada FROM tabela
  
 -- SELECT * FROM    FINANCE.CONTASRECEBER where CRCNFATURA=114380       PCTCNUMEROCONTAREC='400.010.0010' ORDER BY CRCNFATURA     AND PCTCNUMEROCONTAREC<>'010.010.0020'
--SELECT * FROM RCR.NOTAFISCAL where numero=20216
--SELECT * FROM RCR.FATURA where numero=20216
-- select * /*ESTNCODIGO*/  from RCR.FATURA
-- INNER OUTER JOIN Tabela_B b
-- SELECT * FROM RCR.ESTADO

-- select nf.numero, rf.numero, rf.* from RCR.FATURA RF JOIN RCR.NOTAFISCAL NF  ON (RF.NUMERO=NF.NUMERO)

/*

lpad('tech', 8, '0'); retorna '0000tech'
SELECT
     CASE WHEN CAMPO1 IS NULL THEN 'CAMPO1 NULL' 
       ELSE CAMPO1 END AS CAMPO1, 
     CAMPO2, 
     CAMPO3, 
     CAMPO4, 
     CAMPO5
FROM TABELA1
WHERE CAMPO1 = dado1 AND CAMPO2 = dado2


--------------------------

select translate('123.456.789-01',' .-', ' ')

*/